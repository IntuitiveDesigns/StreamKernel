# ==========================================
# StreamKernel Benchmark Profile (UNCORKED)
# ==========================================

# --- Pipeline Core ---
pipeline.id=synthetic-bench
pipeline.parallelism=12
# Slightly smaller batch to keep threads agile
pipeline.batch.size=5000

# --- Source: Synthetic Ring Buffer ---
source.type=SYNTHETIC
source.plugin.id=SYNTHETIC
source.synthetic.payload.size=1024
source.synthetic.buffer.size=524288
source.unsafe.reuse.batch=true

# --- Security: OPA Sidecar (Cached) ---
security.plugin.id=OPA_SIDECAR
security.opa.url=http://localhost:8181/v1/data/streamkernel/authz/allow
security.opa.cache.ttl.ms=600000

# --- Sink: Kafka (Redpanda) ---
sink.type=KAFKA
sink.plugin.id=KAFKA
sink.kafka.topic=arena-bench-test
sink.kafka.bootstrap.servers=localhost:9092

# --- PRODUCER TUNING (Latency + Throughput Hybrid) ---

# 1. Send immediately (Don't sleep for 20ms)
sink.kafka.producer.linger.ms=5

# 2. Keep batches large enough to be efficient, but flushable
sink.kafka.producer.batch.size=131072

# 3. DISABLE compression (Save CPU for throughput on localhost)
sink.kafka.producer.compression.type=lz4

# 4. Massive Buffer (256MB) to prevent blocking application threads
sink.kafka.producer.buffer.memory=268435456

# 5. Allow more in-flight data (Pipelining)
sink.kafka.producer.max.in.flight.requests.per.connection=5

# 6. Safety/Speed balance
sink.kafka.producer.acks=1
