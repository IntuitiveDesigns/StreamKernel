# =============================================================================
#  STREAM KERNEL - ENTERPRISE PROFILE (SECURE & DURABLE)
# =============================================================================

# --- IDENTITY ---
pipeline.name=StreamKernel-Enterprise
pipeline.version=2.1.0-Secure
app.service.account=service-account-1

# --- PIPELINE CONCURRENCY ---
pipeline.parallelism=24
pipeline.app.batch.size=1000

# --- OBSERVABILITY ---
metrics.enabled=true
metrics.type=PROMETHEUS
metrics.prometheus.port=8080
streamkernel.speedometer.window.seconds=5

# --- SOURCE (TESTING) ---
source.type=SYNTHETIC
source.topic=streamkernel-input
source.synthetic.payload.size=1024
source.synthetic.high.entropy=false

# --- SINK (KAFKA) ---
sink.type=KAFKA
sink.topic=arena-bench-test
sink.partitions=24

# --- TRANSFORM / CACHE ---
transform.type=NOOP
cache.type=NOOP

# =============================================================================
#  OPA AUTHORIZATION (BEST PRACTICE)
# =============================================================================
# If StreamKernel runs on HOST and OPA is in Docker with port published:
security.opa.url=http://localhost:8181/v1/data/streamkernel/authz/allow

# =============================================================================
#  KAFKA CONNECTION & SECURITY
# =============================================================================
kafka.broker=localhost:9092

# Choose ONE of these two profiles:
# --- Profile A: PLAINTEXT (dev/bench)
kafka.security.protocol=PLAINTEXT

# --- Profile B: SSL (mTLS)
# kafka.security.protocol=SSL
kafka.ssl.endpoint.identification.algorithm=
kafka.ssl.truststore.location=C:/workspace/StreamKernel/secrets/kafka.truststore.jks
kafka.ssl.truststore.password=changeit
kafka.ssl.keystore.location=C:/workspace/StreamKernel/secrets/kafka.client.keystore.jks
kafka.ssl.keystore.password=changeit
kafka.ssl.key.password=changeit

# =============================================================================
#  PRODUCER TUNING
# =============================================================================
# Choose ONE of these two intent profiles:

# --- Durable intent (recommended for "secure & durable")
kafka.producer.acks=all
kafka.producer.idempotence=true
kafka.producer.retries=2147483647
kafka.producer.delivery.timeout.ms=120000

# --- Benchmark intent (uncomment to maximize throughput; not durable)
# kafka.producer.acks=0
# durable
# kafka.producer.idempotence=true
# benchmark
# kafka.producer.idempotence=false
# kafka.producer.retries=0
# kafka.producer.delivery.timeout.ms=120000

# Performance knobs (ok for both)
kafka.producer.compression=lz4
kafka.producer.max.in.flight.requests.per.connection=5
kafka.producer.batch.size=65536
kafka.producer.linger.ms=5
kafka.producer.buffer.memory=268435456
kafka.producer.max.request.size=10485760

# --- CONSUMER DEFAULTS (kept; used when source.type=KAFKA) ---
kafka.group.id=streamkernel-consumer-group
kafka.auto.offset.reset=earliest

# =============================================================================
#  DLQ (BEST PRACTICE: DURABLE)
# =============================================================================
dlq.type=KAFKA_DLQ
dlq.topic=streamkernel-dlq
dlq.serializer.type=STRING
dlq.kafka.producer.acks=all
dlq.kafka.producer.idempotence=true
dlq.kafka.producer.linger.ms=5
dlq.kafka.producer.batch.size=65536
dlq.kafka.producer.compression=lz4

# Optional DLQ-specific tuning (otherwise DLQ sink defaults apply)
# dlq.kafka.producer.acks=all
# dlq.kafka.producer.idempotence=true
# dlq.kafka.producer.linger.ms=5
# dlq.kafka.producer.batch.size=65536

# --- MongoDB (kept; used when sink.type=MONGODB) ---
mongodb.uri=mongodb://localhost:27017
mongodb.database=support_db
mongodb.collection=tickets_vectorized
