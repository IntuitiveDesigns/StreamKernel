# =============================================================================
#  STREAM KERNEL - BENCHMARK PROFILE (MAX THROUGHPUT / AT-MOST-ONCE)
#  Purpose:
#   - Peak EPS numbers
#   - NOT durable (acks=0) and NOT idempotent
#   - Use only for controlled benchmarks where data-loss is acceptable
# =============================================================================

# --- IDENTITY ---
pipeline.name=StreamKernel-Benchmark
pipeline.version=2.1.0-Benchmark

# --- PIPELINE CONCURRENCY ---
# Virtual threads are cheap; start high and tune based on CPU + broker saturation.
pipeline.parallelism=50
# App-level fetch batch size (Orchestrator). Note: SyntheticSource currently ignores this
# and always returns 4000 items per batch. See SyntheticSource PRE_BAKED_BATCH_SIZE.
pipeline.app.batch.size=4000

# --- OBSERVABILITY ---
metrics.enabled=true
metrics.type=PROMETHEUS
metrics.prometheus.port=8080

# --- SOURCE ---
source.type=SYNTHETIC
source.synthetic.payload.size=1024
source.synthetic.high.entropy=false
source.topic=streamkernel-input

# --- SINK ---
sink.type=KAFKA
sink.topic=streamkernel-bench-test
sink.partitions=24

# --- TRANSFORM / CACHE ---
transform.type=NOOP
cache.type=NOOP

# =============================================================================
#  KAFKA PRODUCER TUNING (BENCHMARK)
# =============================================================================
kafka.broker=localhost:9092

# 1) DURABILITY / RELIABILITY (DISABLED)
kafka.producer.acks=0
kafka.producer.idempotence=false
kafka.producer.retries=2147483647
kafka.producer.delivery.timeout.ms=120000

# 2) PERFORMANCE
kafka.producer.compression=lz4
kafka.producer.max.in.flight.requests.per.connection=5

# 3) BATCHING
# 4MB batches (aggressive; good for local/lab)
kafka.producer.batch.size=4194304
# 0ms linger (send immediately when full)
kafka.producer.linger.ms=0
# 1GB buffer (aggressive; ensure your container/host has headroom)
kafka.producer.buffer.memory=1073741824
# 10MB max request
kafka.producer.max.request.size=10485760

# --- CONSUMER DEFAULTS (Ignored for Synthetic) ---
kafka.group.id=streamkernel-consumer-group
kafka.auto.offset.reset=earliest

dlq.type=DLQ_LOG